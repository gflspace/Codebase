# ═══════════════════════════════════════════════════════════════
#  QwickServices CIS — Production Environment Configuration
# ═══════════════════════════════════════════════════════════════
#
# INSTRUCTIONS:
# 1. Copy this file to .env.production
# 2. Replace ALL "CHANGE_ME_*" placeholders with secure random values
# 3. Generate secrets with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# 4. Never commit .env.production to version control

# ─── Core ─────────────────────────────────────────────────────────
NODE_ENV=production
PORT=3001

# ─── Database ─────────────────────────────────────────────────────
DB_HOST=localhost
DB_PORT=5432
DB_NAME=qwick_cis
DB_USER=cis_app_user
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD
DB_SSL=true
DB_POOL_MIN=2
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT_MS=30000
DB_POOL_CONNECTION_TIMEOUT_MS=5000
DB_STATEMENT_TIMEOUT=30000

# ─── Authentication ───────────────────────────────────────────────
# JWT secret must be 64+ characters. Generate with crypto.randomBytes(32).toString('hex')
JWT_SECRET=CHANGE_ME_RANDOM_64_CHARS
JWT_EXPIRES_IN=24h

# ─── Webhook Security ─────────────────────────────────────────────
# HMAC secret for webhook signature verification
HMAC_SECRET=CHANGE_ME_RANDOM_64_CHARS
# Webhook secret for Laravel platform authentication
WEBHOOK_SECRET=CHANGE_ME_RANDOM_64_CHARS
# Comma-separated list of allowed webhook sources
WEBHOOK_ALLOWED_SOURCES=qwickservices

# ─── Enforcement ──────────────────────────────────────────────────
# Shadow mode: if true, enforcement actions are logged but not executed
SHADOW_MODE=true
# Kill switch: if true, ALL enforcement is disabled (emergency use only)
ENFORCEMENT_KILL_SWITCH=false
# Scoring model: 3-layer (legacy) or 5-component (recommended)
SCORING_MODEL=5-component

# ─── Redis / Event Bus ────────────────────────────────────────────
# Redis connection URL for event bus and caching
REDIS_URL=redis://localhost:6379
# Event bus backend: memory (dev only) or redis (production)
EVENT_BUS_BACKEND=redis

# ─── Rate Limiting ────────────────────────────────────────────────
# Rate limit window in milliseconds
RATE_LIMIT_WINDOW_MS=60000
# Maximum requests per window (global)
RATE_LIMIT_MAX=100
# Maximum AI endpoint requests per window
RATE_LIMIT_AI_MAX=10
# Maximum write endpoint requests per window
RATE_LIMIT_WRITE_MAX=30

# ─── Notifications ────────────────────────────────────────────────
# SMTP settings for email notifications
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASSWORD=CHANGE_ME_SENDGRID_API_KEY
SMTP_FROM=cis@qwickservices.com

# Slack webhook for critical alerts (optional)
SLACK_WEBHOOK_URL=

# ─── External URLs ────────────────────────────────────────────────
# Dashboard frontend URL (for CORS and links)
DASHBOARD_URL=https://cis.qwickservices.com
# API base URL (for webhook callbacks)
API_BASE_URL=https://api-cis.qwickservices.com

# ─── AI / LLM Integration ─────────────────────────────────────────
# OpenAI API key for AI-powered analysis (optional)
OPENAI_API_KEY=
# OpenAI model to use (gpt-4o-mini, gpt-4o, gpt-4-turbo, etc.)
OPENAI_MODEL=gpt-4o-mini

# ─── Observability ────────────────────────────────────────────────
# Logging level: debug, info, warn, error
LOG_LEVEL=info
# Graceful shutdown timeout in milliseconds
SHUTDOWN_TIMEOUT_MS=10000

# ═══════════════════════════════════════════════════════════════
#  Security Checklist (Production Only)
# ═══════════════════════════════════════════════════════════════
#
# ✓ All CHANGE_ME_* values replaced with secure random strings
# ✓ DB_PASSWORD is strong (20+ chars, mixed case, numbers, symbols)
# ✓ JWT_SECRET, HMAC_SECRET, WEBHOOK_SECRET are cryptographically random
# ✓ DB_SSL=true for encrypted database connections
# ✓ SHADOW_MODE=true initially, disable after testing enforcement
# ✓ ENFORCEMENT_KILL_SWITCH=false (only enable for emergencies)
# ✓ REDIS_URL points to production Redis (not localhost)
# ✓ EVENT_BUS_BACKEND=redis (never 'memory' in production)
# ✓ SMTP credentials configured for email notifications
# ✓ DASHBOARD_URL and API_BASE_URL use HTTPS
# ✓ LOG_LEVEL=info (not 'debug' to avoid sensitive data exposure)
# ✓ This file is added to .gitignore
#
# ═══════════════════════════════════════════════════════════════
